{% extends "layouts/base.html" %}
{% from "macros/variant.html" import omim_links %}

{% block body_content %}
	<div class="panel-group" id="filter-accordion">
		<div class="panel panel-default">
			<div class="panel-heading">
				<h4 class="panel-title">
					<a role="button" data-toggle="collapse" data-parent="#accordion" href="#view-filters">Filters</a>
				</h4>
			</div>

			<div id="view-filters" class="panel-collapse collapse">
				<div class="panel-body">
					<form method="get" action="{{ url_for('variants.variants', case_id=case_id) }}">
						<div class="form-group">
							<div class="row">
								<div class="col-xs-6">
									<label class="control-label">Frequency</label>
									<input type="text" class="form-control" name="frequency" type="number" placeholder="0.0004" step="0.0001" value="{{ frequency }}">
								</div>
								<div class="col-xs-6">
									<label class="control-label">CADD</label>
									<input type="text" class="form-control" name="cadd" type="number" placeholder="23.4" step="0.1" value="{{ cadd }}">
								</div>
							</div>
						</div>

						<div class="form-group">
							<div class="row">
								<div class="col-xs-10">
									<label class="control-label">Genes</label>
		                			<input type="text" class="form-control" name="gene_symbol" type="text" placeholder="ADK,LPP" value="{{ (gene_symbols or '')|join(',') }}">
								</div>
								<div class="col-xs-2">
									<label class="control-label">Submit</label>
									<button class="btn btn-default form-control" type="submit">Filter</button>
								</div>
							</div>
						</div>
					</form>	
				</div>
			</div>
		</div>
	</div>

	<div class="table-responsive">
		<table class="table table-bordered table-hover">
			<thead>
				<tr>
					<th>Rank #</th>
					<th>Score</th>
					<th>Chromosome</th>
					<th>Gene</th>
					<th>Consequence</th>
					<th>1000G</th>
					<th>CADD</th>
				</tr>
			</thead>
			<tbody>
				{% for variant in variants %}
					<tr>
						<td><a href="{{ url_for('variants.variant', case_id=case_id, variant_id=variant.variant_id) }}">{{ variant.index }}</a></td>
						<td>{{ variant.rank_score }}</td>
						<td>{{ variant.CHROM }}</td>
						<td>{{ omim_links(variant.genes) }}</td>
						<td>{{ variant.most_severe_consequence or '-' }}</td>
						<td>
							{% if variant.thousand_g %}
								{{ variant.thousand_g|round(4) }}
							{% else %}
								<small class="text-muted">-</small>
							{% endif %}
						</td>
						<td>{{ variant.cadd_score or '-' }}</td>
					</tr>
				{% else %}
					<p>No more variants to show.</p>
				{% endfor %}
			</tbody>
		</table>
	</div>

	{{ query_dict.update({'skip': next_skip})|default('', True) }}
	<a href="{{ url_for('variants.variants', case_id=case_id, **query_dict) }}" class="btn btn-default">Load more</a>
{% endblock %}
